---
title: 远程服务器注意事项
---

## 重启注意事项

远程服务器重启时需要注意两点。

1. 远程服务器在重启前，要中止正在执行的服务

   计算机的硬盘最怕在高速存储时断电或重启，非常容易造成硬盘损坏。所以，在重启前先中止你的服务，甚至可以考虑暂时断开对外提供服务的网络。

   可能你会觉得服务器有这么娇贵吗？我的笔记本电脑经常强行关机，也没有发现硬盘损坏啊？这是因为你的个人计算机没有很多人访问，强制断电时硬盘并没有进行数据交换。小心驶得万年船！

2. 重启命令的选用

   Linux 可以识别的重启命令有很多条，但是建议大家使用 "shutdown-r now" 命令重启。这条命令在重启时会正常保存和中止服务器中正在运行的程序，是安全命令。

   最好在重启前执行几次 "sync" 命令，这条命令是数据同步命令，可以让暂时保存在内存中的数据同步到硬盘上。

   重启和关机也是服务器需要注意的操作规范，不正确的重启和关机造成服务器故障的不在少数。

## 不要在服务器访问高峰运行高负载命令

在服务器访问高峰，如果使用一些对服务器压力较大的命令，有可能会造成服务器响应缓慢甚至死机。

哪些命令是高负载命令呢？如果大家使用过 Windows 操作系统，则也会留意一些操作会给计算机带来较大的运算压力，道理都是一样的，如复制大量的数据、压缩或者解压缩大文件、大范围的硬盘搜索等。

服务器的访问高峰期一般认为是在 17:00-24:00。当然，每台服务器具体提供的服务不同，访问高峰期有时也会有所出入。比如，服务器主要是供美国人民访问的，那就要考虑时差的问题；或者服务器提供的服务很特殊，访问高峰期可能也不同。

高负载命令一般建议在凌晨的 4:00-5:00 执行。那么，是不是说我们需要在凌晨上班？当然不是，这谁受得了啊？我们可以使用系统的计划任务，让操作自动在指定的时间段执行。

## 远程配置防火墙时不要把自己踢出服务器

防火墙是指将内网和外网分开，并依照数据包的 IP 地址、端口号和数据包中的数据来判断是否允许数据包通过的网络设备。

防火墙可以是硬件防火墙设备，也可以是服务器上安装的防火墙软件。

简单来讲，防火墙就是根据数据包自身的参数来判断是否允许数据包通过的网络设备。我们的服务器要想在公网中安全地使用，就需要使用防火墙过滤有害的数据包。

但在配置防火墙时，如果管理员对防火墙不是很熟悉，就有可能把自己的正常访问数据包和有害数据包全部过滤掉，导致自己也无法正常登录服务器。比如说，防火墙关闭了远程连接的 SSH 服务的端口。

防火墙配置完全是靠手工命令完成的，配置规则和配置命令相对也比较复杂，万一设置的时候心不在焉，悲剧就发生了。如何避免这种趟尬的情况发生呢？

最好的方法当然是在服务器本地配置防火墙，这样就算不小视自己的远程登录给过滤了，还可以通过本机登录来进行恢复。如果服务器已经在远程登录了，要配置防火墙，那么最好在本地测试完善后再进行上传，这样会把发生故障的概率降到最低。

虽然在本地测试好了，但是传到远程服务器上时仍有可能发生问题。于是笔者想到一个笨办法，如果需要远程配置防火墙，那么先写一个系统定时任务，让它每 5 分钟清空一下防火墙规则，就算写错了也还有反悔的机会，等测试没有问题了再刪除这个系统定时任务。

总之，大家可以使用各种方法，只要留意不要在配置防火墙时把自己踢出服务器就好了。

指定合理的密码规范并定期更新
除了前面给大家介绍设置密码需要遵守复杂性、易记忆和时效性的三原则外，还需要注意密码的保存。

日常使用的密码，我们最简单的原则是写下来。服务器可能有很多，不可能所有的服务器都使用同样的密码，最好每台服务器的密码都不尽相同(但是在实际的工作中也不现实)。一般的做法是给服务器分类，每类服务器的密码一致，这样可以有效地减少密码的数量。但是在有大量服务器的情况下，密码的数量还是很可怕的。

总之，合理的密码还要有合适的保存方式，这些在构建服务器架构的时候都是必须考虑的内容。

## 合理分配权限

管理服务器要遵守一个最基本的原则: **给予用户最小的权限**。

初次接触服务器的人会很迷惑，我们所有同事都使用管理员 root 账户登录多好，省得还要学习如何添加用户、设置权限。这样操作，如果是对个人计算机来讲问题不大，如日常使用的 Windows 桌面系统，但如果是服务器，就会出现重大的安全隐患。

在实际的工作中，因为给内部员工分配的权限不合理而导致数据泄密甚至触犯法律的情况屡见不鲜。所以，在服务器上，合理的权限规划必不可少！而且就算只有你是这台服务器的 root，我们也建议在管理服务器时，能使用普通用户完成的操作都使用普通用户，确实完成不了的操作要么进行授权，要么再切换到 root 执行。因为 Linux 上的 root 用户权限实在过大，一旦误操作，后果是严重的，下场是惨淡的。

在实际的工作中，越是重要的服务器，对权限的管理越严格。原则上，在能够完成工作的前提下，分配的权限越小越安全。当然，权限越小，你需要做的规划和权限分配任务就越多，但是服务器也越可靠。

## 定期备份重要数据和日志

没有备份的服务器，就是在作死!
